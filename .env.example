# ==============================================================================
# Micros Monorepo - Consolidated Environment Configuration
# ==============================================================================
# Single source of truth for all service configuration.
# Copy this to .env.dev or .env.prod and customize as needed.
# ==============================================================================

# ------------------------------------------------------------------------------
# Deployment Mode
# ------------------------------------------------------------------------------
ENVIRONMENT=dev                           # dev or prod
COMPOSE_PROJECT_NAME=micros-dev           # Docker Compose project name (micros-dev or micros-prod)

# ------------------------------------------------------------------------------
# Database Configuration
# ------------------------------------------------------------------------------
# PostgreSQL (auth-service)
POSTGRES_PORT=5432                        # Dev: 5432 (host), Prod: 10010
DATABASE_URL=postgres://postgres:password@host.docker.internal:5432/auth_db

# MongoDB (document, notification, payment services)
MONGO_PORT=27017                          # Dev: 27017 (host), Prod: 10008
MONGODB_URI=mongodb://host.docker.internal:27017
MONGODB_DATABASE=micros_db

# Redis (all services)
REDIS_PORT=6379                           # Dev: 6379 (host), Prod: 10009
REDIS_URL=redis://host.docker.internal:6379/0

# ------------------------------------------------------------------------------
# Service Ports (Host → Container)
# Format: HEALTH_PORT:GRPC_PORT
# Dev: 9xxx range, Prod: 10xxx range
# ------------------------------------------------------------------------------

# Auth Service (PostgreSQL)
AUTH_SERVICE_HEALTH_PORT=9005             # Dev 9005, Prod 10005 → container:3000
AUTH_SERVICE_GRPC_PORT=50051              # gRPC port → container:3001

# Document Service (MongoDB)
DOCUMENT_SERVICE_HEALTH_PORT=9007         # Dev 9007, Prod 10007 → container:8080
DOCUMENT_SERVICE_GRPC_PORT=50052          # gRPC port → container:8081

# Notification Service (MongoDB)
NOTIFICATION_SERVICE_HEALTH_PORT=9008     # Dev 9008, Prod 10008 → container:3000
NOTIFICATION_SERVICE_GRPC_PORT=50053      # gRPC port → container:3001

# Payment Service (MongoDB)
PAYMENT_SERVICE_HEALTH_PORT=9009          # Dev 9009, Prod 10009 → container:3003
PAYMENT_SERVICE_GRPC_PORT=50054           # gRPC port → container:3004

# GenAI Service (MongoDB)
GENAI_SERVICE_HEALTH_PORT=9010            # Dev 9010, Prod 10010 → container:8080
GENAI_SERVICE_GRPC_PORT=50055             # gRPC port → container:8081

# Ledger Service (PostgreSQL)
LEDGER_SERVICE_HEALTH_PORT=9011           # Dev 9011, Prod 10011 → container:8080
LEDGER_SERVICE_GRPC_PORT=50056            # gRPC port → container:8081

# ------------------------------------------------------------------------------
# Observability Stack Ports (Host → Container)
# ------------------------------------------------------------------------------
PROMETHEUS_PORT=9000                      # Dev 9000, Prod 10000 → container:9090
LOKI_PORT=9001                            # Dev 9001, Prod 10001 → container:3100
GRAFANA_PORT=9002                         # Dev 9002, Prod 10002 → container:3000
TEMPO_PORT=9003                           # Dev 9003, Prod 10003 → container:3200
PROMTAIL_PORT=9004                        # Dev 9004, Prod 10004 → container:9080

# Observability Credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin              # CHANGE IN PRODUCTION

# OpenTelemetry
OTLP_ENDPOINT=http://tempo:4317

# ------------------------------------------------------------------------------
# Auth Service Configuration
# ------------------------------------------------------------------------------
SERVICE_NAME=auth-service
SERVICE_VERSION=0.1.0
LOG_LEVEL=info

# JWT Configuration
JWT_PRIVATE_KEY_PATH=keys/private.pem
JWT_PUBLIC_KEY_PATH=keys/public.pem
JWT_ACCESS_TOKEN_EXPIRY_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRY_DAYS=7
JWT_APP_TOKEN_EXPIRY_MINUTES=60

# Google OAuth Configuration (Optional)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:9006/auth/google/callback

# Gmail SMTP Configuration (Optional - for direct email from auth-service)
GMAIL_USER=
GMAIL_APP_PASSWORD=

# ------------------------------------------------------------------------------
# Document Service Configuration
# ------------------------------------------------------------------------------
DOCUMENT_SERVICE_LOG_LEVEL=info
STORAGE_BACKEND=local
STORAGE_LOCAL_PATH=./storage
DOCUMENT_SERVICE_SIGNING_SECRET=dev-signing-secret

# Document Processing Worker
WORKER_ENABLED=true
WORKER_COUNT=4
QUEUE_SIZE=100
COMMAND_TIMEOUT_SECONDS=300
TEMP_DIR=/tmp/document-processing

# ------------------------------------------------------------------------------
# Notification Service Configuration
# ------------------------------------------------------------------------------
NOTIFICATION_MONGODB_URI=mongodb://host.docker.internal:27017
NOTIFICATION_MONGODB_DATABASE=notification_db

# SMTP/Email Configuration (Gmail)
NOTIFICATION_SMTP_HOST=smtp.gmail.com
NOTIFICATION_SMTP_PORT=587
NOTIFICATION_SMTP_USER=
NOTIFICATION_SMTP_PASSWORD=
NOTIFICATION_SMTP_FROM_EMAIL=noreply@example.com
NOTIFICATION_SMTP_FROM_NAME=Notification Service
NOTIFICATION_SMTP_ENABLED=false

# Msg91 SMS Configuration
NOTIFICATION_MSG91_AUTH_KEY=
NOTIFICATION_MSG91_SENDER_ID=
NOTIFICATION_MSG91_ENABLED=false

# FCM Push Configuration
NOTIFICATION_FCM_PROJECT_ID=
NOTIFICATION_FCM_SERVICE_ACCOUNT_KEY=
NOTIFICATION_FCM_ENABLED=false

# Notification Service Integration (for auth-service)
NOTIFICATION_SERVICE_URL=http://notification-service:3001
NOTIFICATION_SERVICE_ENABLED=false
NOTIFICATION_SERVICE_TIMEOUT=30

# ------------------------------------------------------------------------------
# Payment Service Configuration
# ------------------------------------------------------------------------------
PAYMENT_DATABASE_URL=mongodb://host.docker.internal:27017
PAYMENT_DATABASE_NAME=payment_db
PAYMENT_REDIS_URL=redis://host.docker.internal:6379/0
PAYMENT_SIGNATURE_ENABLED=false
PAYMENT_SIGNATURE_SECRET=dev-secret

# UPI Configuration
PAYMENT_UPI_VPA=merchant@upi
PAYMENT_UPI_MERCHANT_NAME=Micros Merchant

# Razorpay Configuration
RAZORPAY_KEY_ID=
RAZORPAY_KEY_SECRET=
RAZORPAY_WEBHOOK_SECRET=
RAZORPAY_API_BASE_URL=https://api.razorpay.com/v1

# ------------------------------------------------------------------------------
# GenAI Service Configuration
# ------------------------------------------------------------------------------
GENAI_MONGODB_URI=mongodb://host.docker.internal:27017
GENAI_MONGODB_DATABASE=genai_db

# Model Configuration (auto-selected based on output format)
GENAI_TEXT_MODEL=gemini-2.0-flash         # For TEXT and STRUCTURED_JSON output
GENAI_AUDIO_MODEL=gemini-2.0-flash        # For AUDIO output (TTS)
GENAI_VIDEO_MODEL=veo-2                   # For VIDEO output

# Content Threshold (bytes) - use max tokens if document content exceeds this
GENAI_DEFAULT_CONTENT_THRESHOLD_BYTES=1048576

# Google API Key (required for Gemini/Veo)
GOOGLE_API_KEY=

# Document Service Integration
DOCUMENT_SERVICE_GRPC_URL=http://document-service:8081

# ------------------------------------------------------------------------------
# Ledger Service Configuration (PostgreSQL)
# ------------------------------------------------------------------------------
LEDGER_DATABASE_URL=postgres://postgres:password@host.docker.internal:5432/ledger_db
LEDGER_DATABASE_MAX_CONNECTIONS=10
LEDGER_DATABASE_MIN_CONNECTIONS=2

# ------------------------------------------------------------------------------
# Billing Service Configuration (PostgreSQL)
# ------------------------------------------------------------------------------
BILLING_SERVICE_HEALTH_PORT=9012            # Dev 9012, Prod 10012 → container:8080
BILLING_SERVICE_GRPC_PORT=50057             # gRPC port → container:8081
BILLING_DATABASE_URL=postgres://postgres:password@host.docker.internal:5432/billing_db
BILLING_DATABASE_MAX_CONNECTIONS=10
BILLING_DATABASE_MIN_CONNECTIONS=2

# Invoicing Service Integration (for billing-service)
INVOICING_SERVICE_URL=http://invoicing-service:8081

# ------------------------------------------------------------------------------
# Reconciliation Service Configuration (PostgreSQL)
# ------------------------------------------------------------------------------
RECONCILIATION_SERVICE_HEALTH_PORT=9013     # Dev 9013, Prod 10013 → container:8080
RECONCILIATION_SERVICE_GRPC_PORT=50058      # gRPC port → container:8081
RECONCILIATION_DATABASE_URL=postgres://postgres:password@host.docker.internal:5432/reconciliation_db
RECONCILIATION_DATABASE_MAX_CONNECTIONS=10
RECONCILIATION_DATABASE_MIN_CONNECTIONS=2

# Service Integrations (for reconciliation-service)
LEDGER_SERVICE_URL=http://ledger-service:8081
GENAI_SERVICE_URL=http://genai-service:8081
DOCUMENT_SERVICE_URL=http://document-service:8081

